<?php
$host = 'localhost'; // Хост, обычно это 'localhost' для локального сервера
$db = 'my_database'; // Имя базы данных, к которой мы подключаемся
$user = 'P_T'; // Имя пользователя MySQL, используемое для подключения
$pass = '123123'; // Пароль пользователя MySQL для аутентификации

// Подключение к базе данных с использованием класса mysqli
$mysqli = new mysqli($host, $user, $pass, $db);

// Проверка подключения: если есть ошибка, выводим сообщение и завершаем выполнение
if ($mysqli->connect_error) {
    die("Ошибка подключения: " . $mysqli->connect_error); // Завершение скрипта с сообщением об ошибке
}

// Запрос на получение списка всех таблиц в базе данных
$result = $mysqli->query("SHOW TABLES");

// Проверка, есть ли таблицы в базе данных
if ($result->num_rows > 0) {
    // Цикл по всем найденным таблицам
    while ($row = $result->fetch_array()) {
        $tableName = $row[0]; // Получение имени текущей таблицы
        echo "<h2>Таблица: $tableName</h2>"; // Вывод заголовка с именем таблицы

        // Запрос на получение структуры текущей таблицы
        $structureResult = $mysqli->query("DESCRIBE $tableName");
        
        // Проверка, есть ли структура таблицы
        if ($structureResult->num_rows > 0) {
            echo "<h3>Структура:</h3><ul>"; // Заголовок для структуры и начало списка
            // Цикл по всем колонкам структуры таблицы
            while ($structureRow = $structureResult->fetch_assoc()) {
                // Вывод информации о колонках (имя и тип)
                echo "<li>{$structureRow['Field']} - {$structureRow['Type']}</li>";
            }
            echo "</ul>"; // Закрытие списка
        }

        // Запрос на получение содержимого текущей таблицы
        $dataResult = $mysqli->query("SELECT * FROM $tableName");
        
        // Проверка, есть ли данные в таблице
        if ($dataResult->num_rows > 0) {
            echo "<h3>Содержимое:</h3><table border='1'><tr>"; // Заголовок для содержимого и начало таблицы
            
            // Цикл по всем полям данных для создания заголовков таблицы
            while ($fieldInfo = $dataResult->fetch_field()) {
                echo "<th>{$fieldInfo->name}</th>"; // Вывод имени поля в заголовок таблицы
            }
            echo "</tr>"; // Закрытие строки заголовков

            // Цикл по всем строкам данных таблицы
            while ($dataRow = $dataResult->fetch_assoc()) {
                echo "<tr>"; // Начало новой строки данных
                foreach ($dataRow as $value) {
                    echo "<td>$value</td>"; // Вывод каждого значения в ячейку таблицы
                }
                echo "</tr>"; // Закрытие строки данных
            }
            echo "</table>"; // Закрытие таблицы
        } else {
            echo "<p>Таблица пустая.</p>"; // Сообщение, если таблица не содержит данных
        }
    }
} else {
    echo "Нет таблиц в базе данных."; // Сообщение, если в базе данных нет таблиц
}

// Закрытие соединения с базой данных
$mysqli->close();

?>
